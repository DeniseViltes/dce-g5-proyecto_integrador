Version 4
SHEET 1 3136 884
WIRE 560 -352 448 -352
WIRE 624 -352 560 -352
WIRE 1008 -352 704 -352
WIRE 1152 -352 1008 -352
WIRE 1200 -352 1152 -352
WIRE 1248 -352 1200 -352
WIRE 1520 -352 1248 -352
WIRE -1392 -336 -1568 -336
WIRE -864 -336 -1312 -336
WIRE -816 -336 -864 -336
WIRE -768 -336 -816 -336
WIRE -496 -336 -768 -336
WIRE -496 -320 -496 -336
WIRE 1248 -272 1248 -352
WIRE -768 -256 -768 -336
WIRE 1152 -256 1152 -352
WIRE -864 -240 -864 -336
WIRE 448 -160 448 -352
WIRE 720 -160 448 -160
WIRE 928 -160 720 -160
WIRE 1152 -160 1152 -192
WIRE 1200 -160 1152 -160
WIRE 1248 -160 1248 -192
WIRE 1248 -160 1200 -160
WIRE -1568 -144 -1568 -336
WIRE -1296 -144 -1568 -144
WIRE -1088 -144 -1296 -144
WIRE -864 -144 -864 -176
WIRE -816 -144 -864 -144
WIRE -768 -144 -768 -176
WIRE -768 -144 -816 -144
WIRE 1200 -144 1200 -160
WIRE -816 -128 -816 -144
WIRE -496 -112 -496 -240
WIRE -432 -112 -496 -112
WIRE 720 -80 720 -160
WIRE 736 -80 720 -80
WIRE 1040 -80 864 -80
WIRE -1296 -64 -1296 -144
WIRE -1280 -64 -1296 -64
WIRE -976 -64 -1152 -64
WIRE -496 -64 -496 -112
WIRE 1040 -64 1040 -80
WIRE -976 -48 -976 -64
WIRE 736 -32 704 -32
WIRE 928 -32 928 -160
WIRE 928 -32 864 -32
WIRE -1280 -16 -1312 -16
WIRE -1088 -16 -1088 -144
WIRE -1088 -16 -1152 -16
WIRE 704 0 704 -32
WIRE 800 0 800 -16
WIRE -1312 16 -1312 -16
WIRE -496 32 -496 16
WIRE 1040 48 1040 16
WIRE -976 64 -976 32
WIRE 800 176 800 0
WIRE 704 224 672 224
WIRE -1216 240 -1216 0
WIRE -1312 288 -1344 288
WIRE 800 288 800 256
WIRE 368 304 368 288
WIRE -1648 320 -1648 304
WIRE 368 320 368 304
WIRE -1648 336 -1648 320
WIRE 672 336 672 224
WIRE -1344 352 -1344 288
WIRE -1216 352 -1216 320
WIRE 672 352 672 336
WIRE -1344 368 -1344 352
WIRE 1520 384 1520 -352
WIRE 864 400 832 400
WIRE 976 400 944 400
WIRE 1072 400 1040 400
WIRE 368 432 368 400
WIRE 1200 432 1136 432
WIRE 1344 432 1280 432
WIRE -1648 448 -1648 416
WIRE 672 448 672 432
WIRE -1344 464 -1344 448
WIRE 976 464 976 448
WIRE -1040 480 -1040 464
WIRE 976 496 976 464
WIRE -1040 512 -1040 480
WIRE 1072 512 1072 400
WIRE 1072 512 1008 512
WIRE 1136 512 1136 432
WIRE 1136 512 1072 512
WIRE 1152 512 1136 512
WIRE 1232 512 1216 512
WIRE 1344 512 1344 432
WIRE 1344 512 1312 512
WIRE 1520 512 1520 464
WIRE 1520 512 1344 512
WIRE -432 528 -432 -112
WIRE -432 528 -1008 528
WIRE 672 528 672 448
WIRE 832 528 832 400
WIRE 832 528 672 528
WIRE 944 528 832 528
WIRE -1344 544 -1344 464
WIRE -1072 544 -1344 544
WIRE 1072 544 1008 544
WIRE 1520 544 1520 512
WIRE -944 560 -1008 560
WIRE 1072 592 1072 544
WIRE -944 608 -944 560
WIRE 976 640 976 560
WIRE 1520 640 1520 624
WIRE -1040 656 -1040 576
WIRE 1072 704 1072 672
WIRE -944 720 -944 688
FLAG 976 640 0
FLAG 1072 704 0
FLAG 976 464 VPOS
FLAG 800 288 0
FLAG 704 224 ctrl
IOPIN 704 224 Out
FLAG 672 336 x
FLAG 672 448 y
FLAG 368 432 0
FLAG 368 304 VPOS
FLAG 1200 -144 0
FLAG 1040 48 0
FLAG 1200 -352 out
FLAG 800 0 d
FLAG 560 -352 in
FLAG 1520 640 0
FLAG 1008 -352 vd
FLAG 704 0 0
FLAG -816 -128 0
FLAG -976 64 0
FLAG -816 -336 out
FLAG -1040 656 0
FLAG -944 720 0
FLAG -1040 480 VPOS
FLAG -1216 352 0
FLAG -1312 288 ctrl
IOPIN -1312 288 Out
FLAG -1344 352 x
FLAG -1344 464 y
FLAG -496 32 0
FLAG -1648 448 0
FLAG -1648 320 VPOS
FLAG -1312 16 0
SYMBOL Opamps\\LT1215 976 464 M0
SYMATTR InstName U2
SYMBOL cap 1216 496 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 3.9n
SYMBOL cap 1040 384 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 13n
SYMBOL res 960 384 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 8k6
SYMBOL res 1328 496 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 360
SYMBOL res 1296 416 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 30k
SYMBOL voltage 1072 576 R0
WINDOW 123 24 116 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -162 166 Left 2
SYMATTR Value2 AC 0
SYMATTR Value PULSE(0 10 0 1n 1n {ton} {T})
SYMATTR InstName Vref1
SYMBOL bv 800 160 R0
SYMATTR InstName B1
SYMATTR Value V=limit(v(ctrl), 0.01, 0.9)
SYMBOL voltage 672 336 R0
WINDOW 0 41 45 Left 2
WINDOW 123 37 65 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName Vz1
SYMATTR Value2 AC 1
SYMATTR Value ""
SYMBOL voltage 368 304 R0
WINDOW 123 24 44 Left 2
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC 1
SYMATTR InstName Vg1
SYMATTR Value 12
SYMBOL cap 1136 -256 R0
WINDOW 0 -44 28 Left 2
WINDOW 3 -47 63 Left 2
SYMATTR InstName C1
SYMATTR Value 150n
SYMBOL res 1232 -288 R0
SYMATTR InstName Rload1
SYMATTR Value {RLOAD}
SYMBOL ind 608 -336 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 738µ
SYMBOL voltage 1040 -80 R0
WINDOW 123 24 44 Left 2
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC 0
SYMATTR InstName Vg2
SYMATTR Value {VIN}
SYMBOL ccm1 800 -48 M0
SYMATTR InstName U1
SYMATTR Value CCM2
SYMATTR SpiceLine Ron=8m
SYMATTR SpiceLine2 VD=0.5 RD=0.05
SYMBOL res 1504 368 R0
SYMATTR InstName R4
SYMATTR Value 100
SYMBOL res 1504 528 R0
SYMATTR InstName R5
SYMATTR Value 2k
SYMBOL cap -880 -240 R0
WINDOW 0 -44 28 Left 2
WINDOW 3 -47 63 Left 2
SYMATTR InstName C2
SYMATTR Value 150n
SYMBOL res -784 -272 R0
SYMATTR InstName Rload2
SYMATTR Value {RLOAD}
SYMBOL ind -1408 -320 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L2
SYMATTR Value 738µ
SYMBOL voltage -976 -64 R0
WINDOW 123 24 44 Left 2
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC 0
SYMATTR InstName Vg3
SYMATTR Value {VIN}
SYMBOL ccm1 -1216 -32 M0
SYMATTR InstName U3
SYMATTR Value CCM2
SYMATTR SpiceLine Ron=8m
SYMATTR SpiceLine2 VD=0.5 RD=0.05
SYMBOL Opamps\\LT1215 -1040 480 M0
SYMATTR InstName U4
SYMBOL voltage -944 592 R0
WINDOW 123 24 116 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -203 182 Left 2
SYMATTR Value2 AC 0
SYMATTR Value PULSE(0 10 0 1n 1n {ton} {T})
SYMATTR InstName Vref2
SYMBOL bv -1216 224 R0
SYMATTR InstName B2
SYMATTR Value V=limit(v(ctrl), 0.01, 0.9)
SYMBOL voltage -1344 352 R0
WINDOW 0 41 45 Left 2
WINDOW 123 37 65 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName Vz2
SYMATTR Value2 AC 1
SYMATTR Value ""
SYMBOL res -512 -336 R0
SYMATTR InstName R6
SYMATTR Value 207
SYMBOL res -512 -80 R0
SYMATTR InstName R7
SYMATTR Value 100
SYMBOL voltage -1648 320 R0
WINDOW 123 24 44 Left 2
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC 1
SYMATTR InstName Vg4
SYMATTR Value 12
TEXT 2592 -136 Left 2 ;Simulation directives
TEXT 2592 -96 Left 2 !.lib average.lib
TEXT 2584 48 Left 2 ;.ac dec 1000 1 100Meg
TEXT 2584 0 Left 2 !.step param RLOAD list 4 10 20 330
TEXT 2584 -24 Left 2 ;;dc Vduty 0.2 0.9 0.01
TEXT 2568 104 Left 2 !.tran 0 5m 0 1u
TEXT 2584 144 Left 2 !.param RLOAD 330
TEXT 2592 424 Left 2 !.param Duty (6.35/Vin)
TEXT 2592 544 Left 2 !.param fsw  200k
TEXT 2584 464 Left 2 !.param ton (Duty/fsw)
TEXT 2592 376 Left 2 !.param Vin 12
TEXT 2584 504 Left 2 !.param T (1/fsw)
TEXT 2584 296 Left 2 ;Dutys: {0.52916, 0.17638888}
