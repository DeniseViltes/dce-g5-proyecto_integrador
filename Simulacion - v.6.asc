Version 4
SHEET 1 10276 2748
WIRE -160 -288 -416 -288
WIRE 336 -288 -160 -288
WIRE 560 -288 336 -288
WIRE 1472 -288 560 -288
WIRE -416 -224 -416 -288
WIRE 336 -224 336 -288
WIRE 560 -224 560 -288
WIRE 1472 -192 1472 -288
WIRE 1408 -144 1312 -144
WIRE 1248 -96 1024 -96
WIRE -160 -80 -160 -288
WIRE -416 -48 -416 -144
WIRE 1472 -48 1472 -96
WIRE 1472 -48 1312 -48
WIRE 336 -16 336 -144
WIRE 560 -16 560 -144
WIRE 1472 0 1472 -48
WIRE 2336 0 1472 0
WIRE 2368 0 2336 0
WIRE 2480 0 2448 0
WIRE 2720 0 2480 0
WIRE 2880 0 2720 0
WIRE 448 32 400 32
WIRE 496 32 448 32
WIRE 1472 48 1472 0
WIRE 2720 64 2720 0
WIRE 2880 64 2880 0
WIRE 3248 96 3248 48
WIRE 336 112 336 80
WIRE 448 112 448 32
WIRE 448 112 336 112
WIRE 560 160 560 80
WIRE 864 160 560 160
WIRE 1024 160 1024 -96
WIRE 1024 160 864 160
WIRE 1472 160 1472 128
WIRE 2336 176 2336 0
WIRE 2368 176 2336 176
WIRE 2480 176 2480 0
WIRE 2480 176 2464 176
WIRE 3248 208 3248 176
WIRE 336 224 336 112
WIRE 560 224 560 160
WIRE 864 224 864 160
WIRE 2720 224 2720 144
WIRE 2880 224 2880 128
WIRE 160 272 80 272
WIRE 272 272 160 272
WIRE 1376 272 624 272
WIRE 1472 272 1472 240
WIRE 1472 272 1376 272
WIRE 80 304 80 272
WIRE 1472 304 1472 272
WIRE 2368 304 2368 176
WIRE 2464 304 2464 176
WIRE 336 352 336 320
WIRE 448 352 336 352
WIRE 560 352 560 320
WIRE 560 352 448 352
WIRE 1472 432 1472 384
WIRE 1744 432 1472 432
WIRE -160 448 -160 0
WIRE -16 448 -160 448
WIRE 1744 448 1744 432
WIRE 2256 448 2224 448
WIRE 2368 448 2368 384
WIRE 2368 448 2336 448
WIRE 2400 448 2368 448
WIRE 80 464 80 384
WIRE 1472 480 1472 432
WIRE 2224 480 2224 448
WIRE 2464 480 2464 384
WIRE 2464 480 2432 480
WIRE 2624 480 2464 480
WIRE -160 496 -160 448
WIRE 448 496 448 352
WIRE 1920 528 1792 528
WIRE 2400 528 2400 448
WIRE 2432 528 2432 480
WIRE 2624 528 2624 480
WIRE -16 544 -16 448
WIRE -16 544 -96 544
WIRE 384 544 -16 544
WIRE 1920 560 1920 528
WIRE 2384 560 2336 560
WIRE 2496 560 2448 560
WIRE 1472 592 1472 560
WIRE 2336 592 2336 560
WIRE -160 672 -160 592
WIRE 448 672 448 592
WIRE 448 672 -160 672
WIRE 1744 672 1744 544
WIRE 1920 672 1920 640
WIRE 2416 672 2416 592
WIRE 2624 672 2624 608
WIRE 2624 672 2416 672
WIRE 448 720 448 672
WIRE 1472 720 1472 672
WIRE -1152 752 -1152 720
WIRE -1568 768 -1616 768
WIRE -1440 768 -1488 768
WIRE -1312 768 -1360 768
WIRE -1184 768 -1312 768
WIRE -544 768 -544 736
WIRE -1056 784 -1120 784
WIRE -976 784 -1056 784
WIRE -800 784 -896 784
WIRE -576 784 -800 784
WIRE -1184 800 -1216 800
WIRE -400 800 -512 800
WIRE -576 816 -592 816
WIRE -1152 832 -1152 816
WIRE -1312 848 -1312 768
WIRE -544 848 -544 832
WIRE -1216 928 -1216 800
WIRE -1056 928 -1056 784
WIRE -1056 928 -1216 928
WIRE -592 944 -592 816
WIRE -512 944 -592 944
WIRE -400 944 -400 800
WIRE -400 944 -432 944
WIRE -592 960 -592 944
WIRE -1312 992 -1312 928
WIRE 2864 1056 2784 1056
WIRE 2992 1056 2864 1056
WIRE 3088 1056 3072 1056
WIRE -592 1088 -592 1040
WIRE 2256 1088 2256 976
WIRE 2864 1088 2864 1056
WIRE -1152 1104 -1152 1072
WIRE 2704 1104 2704 1072
WIRE -1504 1120 -1520 1120
WIRE -1472 1120 -1504 1120
WIRE -1312 1120 -1392 1120
WIRE -1184 1120 -1312 1120
WIRE 2784 1120 2784 1056
WIRE 2784 1120 2736 1120
WIRE -1056 1136 -1120 1136
WIRE -976 1136 -1056 1136
WIRE -800 1136 -800 784
WIRE -800 1136 -896 1136
WIRE 2368 1136 2320 1136
WIRE 2544 1136 2448 1136
WIRE 2672 1136 2544 1136
WIRE -1184 1152 -1216 1152
WIRE 2784 1152 2736 1152
WIRE -1312 1200 -1312 1120
WIRE 2704 1200 2704 1168
WIRE 2864 1200 2864 1168
WIRE 2256 1232 2256 1184
WIRE -1216 1264 -1216 1152
WIRE -1056 1264 -1056 1136
WIRE -1056 1264 -1216 1264
WIRE 2544 1312 2544 1136
WIRE 2608 1312 2544 1312
WIRE 2784 1312 2784 1152
WIRE 2784 1312 2688 1312
WIRE 2928 1312 2784 1312
WIRE 3104 1312 3008 1312
WIRE 3120 1312 3104 1312
WIRE -1312 1344 -1312 1280
WIRE 2256 1360 2256 1312
FLAG 1376 272 Vf
FLAG 2864 1200 0
FLAG 2256 1360 0
FLAG 80 464 0
FLAG -1312 992 0
FLAG -1312 1344 0
FLAG -592 1088 0
FLAG 2720 224 0
FLAG 2880 224 0
FLAG -1152 832 VPOSA
FLAG -544 848 VPOSA
FLAG 2496 560 VPOSA
FLAG 2704 1200 VPOSA
FLAG -1152 1168 VPOSA
FLAG -416 -48 0
FLAG 1744 672 0
FLAG 1472 720 0
FLAG 1920 672 0
FLAG 448 720 0
FLAG 2720 0 Vo
FLAG 3248 208 0
FLAG 3248 48 VPOSA
FLAG 160 272 Vref
FLAG 2224 480 0
FLAG -1152 1072 0
FLAG -1152 720 0
FLAG -544 736 0
FLAG 2704 1072 0
FLAG 2336 592 0
FLAG -1504 1120 vf
FLAG -1616 768 Vref
FLAG -400 800 vref-c
FLAG 3104 1312 vref-c
FLAG 3088 1056 Vs
FLAG 2416 672 Vs
FLAG 2256 976 Vlc
FLAG 864 224 Vlc
DATAFLAG 1728 0 ""
DATAFLAG 1120 272 ""
DATAFLAG 2576 0 ""
DATAFLAG 1184 -96 ""
DATAFLAG 1456 -288 ""
DATAFLAG 2288 0 "$-V(Vo)"
SYMBOL pnp 400 80 R180
SYMATTR InstName Q1
SYMATTR Value BC557B
SYMBOL pnp 496 80 M180
SYMATTR InstName Q2
SYMATTR Value BC557B
SYMBOL npn 272 224 R0
WINDOW 3 52 65 Left 2
SYMATTR Value BC547B
SYMATTR InstName Q3
SYMBOL npn 624 224 M0
WINDOW 3 42 64 Left 2
SYMATTR Value BC547B
SYMATTR InstName Q4
SYMBOL pnp 1408 -96 M180
SYMATTR InstName Q5
SYMATTR Value TIP42C
SYMBOL npn 1248 -144 R0
SYMATTR InstName Q6
SYMATTR Value TIP41C
SYMBOL res 1456 144 R0
SYMATTR InstName R5
SYMATTR Value 390
SYMBOL res 1456 288 R0
SYMATTR InstName R6
SYMATTR Value 1K
SYMBOL res 2704 48 R0
SYMATTR InstName RL
SYMATTR Value R = 100*(1-TIME)
SYMBOL voltage 80 288 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC {VREFAC}
SYMATTR InstName V1
SYMATTR Value {VREFDC}
SYMBOL voltage -416 -240 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC {VINAC}
SYMATTR InstName VIN
SYMATTR Value {VINDC}
SYMBOL res 320 -240 R0
SYMATTR InstName R8
SYMATTR Value {RE}
SYMBOL res 544 -240 R0
SYMATTR InstName R9
SYMATTR Value {RE}
SYMBOL cap 2864 64 R0
SYMATTR InstName C3
SYMATTR Value 1µ
SYMBOL res 2464 -16 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 0.1
SYMBOL res 3088 1040 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 1k
SYMBOL res 3024 1296 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 1k
SYMBOL res 2848 1072 R0
SYMATTR InstName R7
SYMATTR Value 100k
SYMBOL res 2704 1296 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 100k
SYMBOL res 2464 1120 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 1k
SYMBOL res 2240 1216 R0
SYMATTR InstName R12
SYMATTR Value 100
SYMBOL npn 2320 1088 M0
SYMATTR InstName Q7
SYMATTR Value BC547B
SYMBOL res -1472 752 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 4.7k
SYMBOL res -1328 832 R0
SYMATTR InstName R14
SYMATTR Value 1.5k
SYMBOL res -880 768 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 1.5k
SYMBOL res -1376 1104 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 8.2k
SYMBOL res -1328 1184 R0
SYMATTR InstName R17
SYMATTR Value 6.8k
SYMBOL res -880 1120 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R18
SYMATTR Value 1.5k
SYMBOL res -416 928 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 1.5k
SYMBOL res -608 944 R0
SYMATTR InstName R19
SYMATTR Value 1.5k
SYMBOL res 1456 464 R0
SYMATTR InstName R21
SYMATTR Value 680
SYMBOL nmos 1792 448 M0
SYMATTR InstName M1
SYMATTR Value 2N7002
SYMBOL voltage 1920 544 R0
WINDOW 3 32 89 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value 5
SYMATTR InstName SELA
SYMBOL npn 384 496 R0
SYMATTR InstName Q10
SYMATTR Value BC547B
SYMBOL npn -96 496 M0
SYMATTR InstName Q11
SYMATTR Value BC547B
SYMBOL res -176 -96 R0
SYMATTR InstName R22
SYMATTR Value 3.3k
SYMBOL res 1456 32 R0
SYMATTR InstName R23
SYMATTR Value 2.7k
SYMBOL OpAmps\\opamp2 2480 560 R90
SYMATTR InstName U6
SYMATTR Value LM324
SYMBOL OpAmps\\opamp2 2704 1200 R180
WINDOW 3 36 85 Left 2
SYMATTR Value LM324
SYMATTR InstName U1
SYMBOL OpAmps\\opamp2 -1152 848 M180
SYMATTR InstName U3
SYMATTR Value LM324
SYMBOL OpAmps\\opamp2 -544 864 M180
SYMATTR InstName U4
SYMATTR Value LM324
SYMBOL voltage 3248 80 R0
SYMATTR InstName VPOSA1
SYMATTR Value 5
SYMBOL res -1344 752 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R24
SYMATTR Value 2.7k
SYMBOL res 2608 512 R0
SYMATTR InstName R25
SYMATTR Value 10k
SYMBOL res 2352 288 R0
SYMATTR InstName R26
SYMATTR Value 1k
SYMBOL res 2448 288 R0
SYMATTR InstName R27
SYMATTR Value 1k
SYMBOL res 2352 432 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R29
SYMATTR Value 10k
SYMBOL res 1456 576 R0
SYMATTR InstName R1
SYMATTR Value 270
SYMBOL OpAmps\\opamp2 -1152 1200 M180
SYMATTR InstName U2
SYMATTR Value LM324
TEXT -1552 232 Left 2 !.op
TEXT -728 -224 Left 2 !.param VINDC 6.35
TEXT -728 -184 Left 2 !.param VINAC 1
TEXT -8 128 Left 2 !.param VREFDC 1.2
TEXT -8 168 Left 2 !.param VREFAC 0
TEXT -1912 232 Left 2 ;.param RL 10
TEXT -728 -136 Left 2 !;dc VIN 4 24
TEXT -1912 312 Left 2 ;.step param RE 330 1.5k 100
TEXT -1912 272 Left 2 ;.step param RL 1u 12 0.2
TEXT -1904 -208 Left 2 ;Mido regulacion de linea
TEXT -1904 -168 Left 2 !.meas DC Vo1rl FIND V(Vo) AT=12
TEXT -1904 -144 Left 2 !.meas DC Vo2rl FIND V(Vo) AT=24
TEXT -1904 -120 Left 2 !.meas DC RegLin PARAM ((Vo2rl-Vo1rl)/12)
TEXT -1904 -64 Left 2 ;Mido regulacion de carga
TEXT -1904 -24 Left 2 !.meas OP Vo1rc FIND V(Vo) AT 100
TEXT -1904 0 Left 2 !.meas OP Vo2rc FIND V(Vo) AT 5
TEXT -1904 24 Left 2 !.meas OP Io1rc FIND I(RL) AT 100
TEXT -1904 48 Left 2 !.meas OP Io2rc FIND I(RL) AT 5
TEXT -1896 112 Left 2 ;Mido eficiencia
TEXT -1896 152 Left 2 ;-100*((V(vo)*I(RL))/(V(VIN)*I(VIN)))
TEXT -1904 72 Left 2 !.meas OP RegCar PARAM (-(Vo2rc-Vo1rc)/(Io2rc-Io1rc))
TEXT 1600 1104 Left 2 ;Elegir opamps de baja Voff
TEXT -1696 592 Left 2 ;La alimentación de los opamps es VPOSA, ver si quiero que sea entre\n+Vcc y 0 o entre +Vcc y -Vcc.
TEXT 1248 768 Left 2 ;SELA es la tensión de control con la que elegimos si la salida es de 5V\no de 3.3V. Cuando SELA = 1, la salida es de 5V y cuando es 0, de 3.3V\n(si lo consideramos como una señal digital). También hay que considerar\nque la alimentación de los opamps va a ser VPOSA y nos convendría\nusar la menor cantidad de tensiones de control diferentes, por lo que\nsería conveniente que VPOSA sea también SELA.
TEXT 2360 -160 Left 2 ;Tener en cuanta que hay "low dropout" cuando la Ro (estática) es baja.
TEXT -1912 -544 Left 2 !.MODEL TIP42C PNP(Is=66.19f Xti=3 Eg=1.11 Vaf=100 Bf=137.6 Ise=862.2f Ne=1.481 Ikf=1.642 Nk=.5695 Xtb=2 Br=5.88 Isc=273.5f Nc=1.24 Ikr=3.555 Rc=79.39m Cjc=870.4p Mjc=.6481 Vjc=.75 Fc=.5 Cje=390.1p Mje=.4343 Vje=.75 Tr=235.4n Tf=23.21n Itf=71.33 Xtf=5.982 Vtf=10 Rb=.1 Vceo=100 Icrating=6 mfg=Texas)
TEXT -1912 -504 Left 2 !.MODEL TIP41C NPN (IS=7.55826e-11 BF=260.542 NF=1.11221 VAF=100 IKF=0.526814 ISE=1e-08 NE=2.18072 BR=26.0542 NR=1.5 VAR=1000 IKR=3.54059 ISC=1e-08 NC=1.63849 RB=4.56157 IRB=0.1 RBM=0.1 RE=0.0162111 RC=0.0810556 XTB=0.1 XTI=1 EG=1.206 CJE=1.93296e-10 VJE=0.4 MJE=0.259503 TF=1e-08 XTF=4.06972 VTF=7.1157 ITF=0.001 CJC=1.09657e-10 VJC=0.730921 MJC=0.23 XCJC=0.803085 FC=0.8 TR=9.01013e-08 PTF=0 Vceo=100 ICrating=6 mfg=ON_Semi)
TEXT -64 -392 Left 2 ;Todos los transistores pueden ser los TIP4x que tienen un beta muy chico o los BC5x7 con uno\nmucho mayor. Mejora la ganancia del circuito pero no tanto respecto a los anteriores. Sin embargo,\nhay que tener en cuenta que pueden haber grandes diferencias entre el circuito real y el simulado.\nEn la hoja de datos, el beta de los TIP4x es de alrededor de 20: muy chico.
TEXT 1504 -264 Left 2 ;Queremos los TIP42 en el transistor de paso porque\nqueremos que sea "low dropout", es decir, baja VCE.
TEXT 2616 344 Left 2 ;Usamos cinco opamps, los cuales se pueden comprar solos en un solo encampsulado\nde a varios. Lo máximo es encapsulado de cuatro juntos, por lo que convendría buscar\nalguna forma de eliminar uno y quedarnos solo con esos cuatro.
TEXT 2304 1064 Left 2 ;Revisar qué hace R11
TEXT -1488 832 Left 2 ;5*R
TEXT -1472 1176 Left 2 ;5.44*R
TEXT -1408 1256 Left 2 ;4.6*R
TEXT -1288 936 Left 2 ;R
TEXT -960 1192 Left 2 ;R
TEXT -960 840 Left 2 ;R
TEXT -496 1000 Left 2 ;R
TEXT -568 1048 Left 2 ;R
TEXT -1016 1296 Left 2 ;Los valores de resistencias fueron elegidos de acuerdo con la presentación\nde la práctica pasada.
TEXT 2840 576 Left 2 !.inc LM324.lib
TEXT -1480 320 Left 2 !.tran 0.99999
TEXT -1472 360 Left 2 ;R = 100*(1-TIME)
TEXT -1904 352 Left 2 !.param RE 470
