Version 4
SHEET 1 10276 1828
WIRE 96 -256 -240 -256
WIRE 320 -256 96 -256
WIRE 1232 -256 320 -256
WIRE -240 -240 -240 -256
WIRE 96 -192 96 -256
WIRE 320 -192 320 -256
WIRE 1232 -160 1232 -256
WIRE 1168 -112 1072 -112
WIRE 1008 -64 784 -64
WIRE 1232 -16 1232 -64
WIRE 1232 -16 1072 -16
WIRE 1232 32 1232 -16
WIRE 2112 32 1232 32
WIRE 2816 32 2240 32
WIRE 2976 32 2816 32
WIRE 96 48 96 -112
WIRE 320 48 320 -112
WIRE 208 96 160 96
WIRE 256 96 208 96
WIRE 1232 160 1232 32
WIRE -240 176 -240 -240
WIRE 96 176 96 144
WIRE 208 176 208 96
WIRE 208 176 96 176
WIRE 320 208 320 144
WIRE 624 208 320 208
WIRE 784 208 784 -64
WIRE 784 208 624 208
WIRE 96 256 96 176
WIRE 320 256 320 208
WIRE 2816 256 2816 32
WIRE 2976 256 2976 32
WIRE 32 304 -160 304
WIRE 992 304 384 304
WIRE 1136 304 992 304
WIRE 1232 304 1232 240
WIRE 1232 304 1136 304
WIRE 1232 336 1232 304
WIRE 96 384 96 352
WIRE 208 384 96 384
WIRE 320 384 320 352
WIRE 320 384 208 384
WIRE 1408 384 1344 384
WIRE -160 400 -160 304
WIRE 208 416 208 384
WIRE 1408 416 1408 384
WIRE 1232 432 1232 416
WIRE 1344 432 1344 384
WIRE 1344 432 1232 432
WIRE 1584 496 1456 496
WIRE -240 528 -240 256
WIRE 1232 528 1232 432
WIRE 2816 528 2816 336
WIRE 2976 528 2976 320
WIRE 208 560 208 496
WIRE -160 576 -160 480
WIRE 2112 608 2112 32
WIRE 2144 608 2112 608
WIRE 2240 608 2240 32
WIRE 2240 608 2224 608
WIRE 1232 656 1232 608
WIRE 2112 672 2112 608
WIRE 2160 672 2112 672
WIRE 2240 672 2240 608
WIRE 2240 672 2192 672
WIRE 2160 688 2160 672
WIRE 2192 688 2192 672
WIRE -1296 768 -1392 768
WIRE -1184 768 -1296 768
WIRE -1056 784 -1120 784
WIRE -1008 784 -1056 784
WIRE -800 784 -928 784
WIRE -576 784 -800 784
WIRE -1184 800 -1216 800
WIRE -400 800 -512 800
WIRE -96 800 -400 800
WIRE 1856 800 1776 800
WIRE 1984 800 1856 800
WIRE 2176 800 2176 752
WIRE 2176 800 2064 800
WIRE -576 816 -592 816
WIRE -1152 832 -1152 816
WIRE 624 832 624 208
WIRE 1248 832 624 832
WIRE 1856 832 1856 800
WIRE -1296 848 -1296 768
WIRE 1776 864 1776 800
WIRE 1776 864 1728 864
WIRE 1360 880 1312 880
WIRE 1536 880 1440 880
WIRE 1664 880 1536 880
WIRE -1216 896 -1216 800
WIRE -1056 896 -1056 784
WIRE -1056 896 -1216 896
WIRE 1776 896 1728 896
WIRE -592 944 -592 816
WIRE -512 944 -592 944
WIRE -400 944 -400 800
WIRE -400 944 -432 944
WIRE -592 960 -592 944
WIRE -1296 992 -1296 928
WIRE 1776 1008 1776 896
WIRE 1968 1008 1776 1008
WIRE 2432 1008 2048 1008
WIRE 1248 1088 1248 1008
WIRE -1632 1120 -1840 1120
WIRE -1472 1120 -1632 1120
WIRE -1296 1120 -1392 1120
WIRE -1184 1120 -1296 1120
WIRE -592 1120 -592 1040
WIRE -1056 1136 -1120 1136
WIRE -1008 1136 -1056 1136
WIRE -800 1136 -800 784
WIRE -800 1136 -928 1136
WIRE -1184 1152 -1216 1152
WIRE 1536 1152 1536 880
WIRE 1616 1152 1536 1152
WIRE 1776 1152 1776 1008
WIRE 1776 1152 1696 1152
WIRE -1296 1200 -1296 1120
WIRE -1216 1248 -1216 1152
WIRE -1056 1248 -1056 1136
WIRE -1056 1248 -1216 1248
WIRE -1296 1344 -1296 1280
WIRE -1840 1424 -1840 1120
WIRE 992 1424 992 304
WIRE 992 1424 -1840 1424
WIRE 1008 1424 992 1424
WIRE -96 1744 -96 800
WIRE 2432 1744 2432 1008
WIRE 2432 1744 -96 1744
FLAG -240 -240 VIN
FLAG 1136 304 Vf
FLAG 208 560 0
FLAG 1856 912 0
FLAG 1248 1088 0
FLAG -160 576 0
FLAG -1296 992 0
FLAG -1632 1120 Vf
FLAG -1296 1344 0
FLAG -592 1120 0
FLAG 2816 528 0
FLAG 2976 528 0
FLAG -1472 768 Vref
FLAG -1152 752 Vref
FLAG -1152 832 0
FLAG -544 832 Vref
FLAG -544 768 0
FLAG 2208 720 Vref
FLAG 1696 912 Vref
FLAG 1696 848 0
FLAG 2144 720 0
FLAG -1152 1168 Vref
FLAG -1152 1104 0
FLAG -240 528 0
FLAG 1232 656 0
FLAG 1408 512 0
FLAG 1584 496 vsel
DATAFLAG 1232 64 ""
DATAFLAG 624 304 ""
SYMBOL pnp 160 144 R180
SYMATTR InstName Q1
SYMATTR Value BD140
SYMBOL pnp 256 144 M180
SYMATTR InstName Q2
SYMATTR Value BD140
SYMBOL npn 32 256 R0
SYMATTR InstName Q3
SYMATTR Value BD139_Cordell
SYMBOL npn 384 256 M0
SYMATTR InstName Q4
SYMATTR Value BD139_Cordell
SYMBOL res 192 400 R0
SYMATTR InstName R1
SYMATTR Value 500
SYMBOL pnp 1168 -64 M180
SYMATTR InstName Q5
SYMATTR Value BD140
SYMBOL npn 1008 -112 R0
SYMATTR InstName Q6
SYMATTR Value BD139_Cordell
SYMBOL res 1216 144 R0
SYMATTR InstName R5
SYMATTR Value 3.16k
SYMBOL res 1216 320 R0
SYMATTR InstName R6
SYMATTR Value 1k
SYMBOL res 2800 240 R0
SYMATTR InstName RL
SYMATTR Value {RL}
SYMBOL voltage -160 384 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC {VREFAC}
SYMATTR InstName V1
SYMATTR Value {VREFDC}
SYMBOL voltage -240 160 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC {VINAC}
SYMATTR InstName VIN
SYMATTR Value {VINDC}
SYMBOL res 80 -208 R0
SYMATTR InstName R8
SYMATTR Value {RE}
SYMBOL res 304 -208 R0
SYMATTR InstName R9
SYMATTR Value {RE}
SYMBOL cap 2960 256 R0
SYMATTR InstName C3
SYMATTR Value 1µ
SYMBOL res 2240 592 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 0.333
SYMBOL OpAmps\\UniversalOpAmp4 2176 720 R90
SYMATTR InstName U1
SYMBOL res 2080 784 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMBOL res 2064 992 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMBOL res 1840 816 R0
SYMATTR InstName R7
SYMBOL OpAmps\\UniversalOpAmp4 1696 880 R180
SYMATTR InstName U2
SYMBOL res 1712 1136 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMBOL res 1456 864 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMBOL res 1232 912 R0
SYMATTR InstName R12
SYMBOL npn 1312 832 M0
SYMATTR InstName Q7
SYMBOL res -1376 752 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMBOL res -1312 832 R0
SYMATTR InstName R14
SYMBOL OpAmps\\UniversalOpAmp4 -1152 784 M180
SYMATTR InstName U3
SYMBOL res -912 768 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMBOL res -1376 1104 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMBOL res -1312 1184 R0
SYMATTR InstName R17
SYMBOL OpAmps\\UniversalOpAmp4 -1152 1136 M180
SYMATTR InstName U4
SYMBOL res -912 1120 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R18
SYMBOL OpAmps\\UniversalOpAmp4 -544 800 M180
SYMATTR InstName U5
SYMBOL res -416 928 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMBOL res -608 944 R0
SYMATTR InstName R19
SYMBOL res 1216 512 R0
SYMATTR InstName R21
SYMBOL nmos 1456 416 M0
SYMATTR InstName M1
TEXT -2648 1512 Left 2 !.op
TEXT -2664 1568 Left 2 !.param VINDC 6.35
TEXT -2664 1608 Left 2 !.param VINAC 1
TEXT -2336 1568 Left 2 !.param VREFDC 1.2
TEXT -2336 1608 Left 2 !.param VREFAC 0
TEXT -1992 1568 Left 2 !.param RL 10
TEXT -2664 1656 Left 2 !;dc VIN 4 24
TEXT -1584 1608 Left 2 !;step param RE 1k 1.5k 100
TEXT -1584 1568 Left 2 !.param RE=470
TEXT -2000 1608 Left 2 !;.step param RL 1k 5 10
TEXT 4592 -2392 Left 2 ;Mido regulacion de linea
TEXT 4592 -2352 Left 2 !.meas DC Vo1rl FIND V(Vo) AT=12
TEXT 4592 -2328 Left 2 !.meas DC Vo2rl FIND V(Vo) AT=24
TEXT 4592 -2304 Left 2 !.meas DC RegLin PARAM ((Vo2rl-Vo1rl)/12)
TEXT 4592 -2248 Left 2 ;Mido regulacion de carga
TEXT 4592 -2208 Left 2 !.meas OP Vo1rc FIND V(Vo) AT 100
TEXT 4592 -2184 Left 2 !.meas OP Vo2rc FIND V(Vo) AT 5
TEXT 4592 -2160 Left 2 !.meas OP Io1rc FIND I(RL) AT 100
TEXT 4592 -2136 Left 2 !.meas OP Io2rc FIND I(RL) AT 5
TEXT 4600 -2072 Left 2 ;Mido eficiencia
TEXT 4600 -2032 Left 2 ;-100*((V(vo)*I(RL))/(V(VIN)*I(VIN)))
TEXT 4592 -2112 Left 2 !.meas OP RegCar PARAM (-(Vo2rc-Vo1rc)/(Io2rc-Io1rc))
TEXT 5296 -2416 Left 2 !.MODEL BC557 PNP(\n* + IS=3.834E-14\n* + NF=1.008\n* + ISE=1.219E-14\n* + NE=1.528\n* + BF=800\n* + IKF=0.08039\n* + VAF=21.11\n* + NR=1.005\n* + ISC=2.852E-13\n* + NC=1.28\n* + BR=14.84\n* + IKR=0.047\n* + VAR=32.02\n* + RB=1\n* + IRB=1E-06\n* + RBM=1\n* + RE=0.6202\n* + RC=0.5713\n* + XTB=0\n* + EG=1.11\n* + XTI=3\n* + CJE=1.23E-11\n* + VJE=0.6106\n* + MJE=0.378\n* + TF=5.595E-10\n* + XTF=3.414\n* + VTF=5.23\n* + ITF=0.1483\n* + PTF=0\n* + CJC=1.084E-11\n* + VJC=0.1022\n* + MJC=0.3563\n* + XCJC=0.6288\n* + TR=1E-32\n* + CJS=0\n* + VJS=0.75\n* + MJS=0.333\n* + FC=0.8027 )\n+ BF=800\n+)
TEXT 5624 -2424 Left 2 !*From Philips SC04 "Small signal transistors 1991"\n* Base spreading parameters (RB,IRB,RBM) estimated. TR derived using BCY58 data\n.model BC546B npn ( IS=7.59E-15 VAF=73.4 BF=480 IKF=0.0962 NE=1.2665\n+ ISE=3.278E-15 IKR=0.03 ISC=2.00E-13 NC=1.2 NR=1 BR=5 RC=0.25 CJC=6.33E-12\n+ FC=0.5 MJC=0.33 VJC=0.65 CJE=1.25E-11 MJE=0.55 VJE=0.65 TF=4.26E-10\n+ ITF=0.6 VTF=3 XTF=20 RB=100 IRB=0.0001 RBM=10 RE=0.5 TR=1.50E-07)
TEXT 5624 -2224 Left 2 !.MODEL 2SA940 PNP (IS=10F BF=93.7926 VAF=100 IKF=1.43805 ISE=2.91448F\n+ NE=1.22255 BR=7.28345 IKR=1.77264 ISC=84.2577P NC=1.45361 RE=1 RC=413.104M\n+ CJE=2P MJE=500M CJC=214.957P VJC=699.997M MJC=499.87M TF=37.4969N\n+ XTF=500.001M VTF=10 ITF=14.2266M TR=10N)
TEXT 5592 -2088 Left 2 !.model BD136 PNP(Is=10f Xti=3 Eg=1.11 Vaf=95.7 Bf=178.7 Ise=134.1f Ne=1.553 Ikf=2 Nk=.8366 Xtb=1.5 Br=5 Isc=85f Nc=2 Ikr=0 Rc=0 Cjc=60p Mjc=.4 Vjc=.8 Fc=.8 Cje=115.6p Mje=.3766 Vje=.7703 Tr=116n Tf=500p Itf=1 Xtf=0 Vtf=10 QCO=1E-10 GAMMA=5n RCO=5)
TEXT 5592 -2040 Left 2 !.MODEL BD139_Cordell npn IS=150f BF=260 VAF=99 IKF=1.2 ISE=70f NE=1.2 NF=1.0 RB=5 RC=0.01 RE=0.08 CJE=293p MJE=0.33 VJE=0.67 CJC=49p MJC=0.39 VJC=0.52 FC=0.5 TF=585p XTF=10000 VTF=35 ITF=20 TR=10n BR=78 IKR=0.14 EG=1.21 XTB=1.14 XTI=3 NC=1.45 ISC=19p NR=1.0 VAR=7.5 IRB=0.03 RBM=0.001 XCJC=0.53 mfg=CA041311
TEXT 5600 -1992 Left 2 !.MODEL BD140 PNP ( IS=2.9537E-13 BF=201.4 NF=1.0 BR=23.765 NR=1.021 ISE=1.8002E-13 NE=1.5 ISC=7.0433p NC=1.38 VAF=137.0 VAR=8.41 IKF=1.0993 IKR=0.10 RB=1.98 RBM=0.01 IRB=0.011 RE=0.1109 RC=0.01 CJE=2.1982E-10 VJE=0.7211 MJE=0.3685 FC=0.5 CJC=6.8291E-11 VJC=0.5499 MJC=0.3668 XCJC=0.5287 XTB=1.4883 EG=1.2343 XTI=3.0 Vceo=80 Icrating=3 mfg=fairchild)
TEXT -1024 1464 Left 2 ;Elegir opamps de baja Voff
TEXT 312 424 Left 2 ;poner una fuente de corriente
TEXT -1312 600 Left 2 ;la alimentación de los opamps es vposa, ver si quiero 0 y vcc o -vcc y +vcc
TEXT 1560 544 Left 2 ;vsel para elegir la tensión, en lo posible ver si podemos usar vposa
TEXT 1112 696 Left 2 ;calcular nueva f para r6 y r5 o r6,r5,r21
TEXT 1808 264 Center 2 ;implementar foldback
TEXT 1848 -224 Left 2 ;hay low dropout cuando la Ro (estática) es baja
